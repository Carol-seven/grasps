---
output:
  github_document:
    pandoc_args: [ "--wrap=preserve", "--columns=80" ]
bibliography: inst/REFERENCES.bib
link-citations: yes
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```


# grasps <img src="man/figures/logo.png" align="right" alt="" width="150">


## Groupwise Regularized Adaptive Sparse Precision Solution


<!-- badges: start -->
[![GitHub R package version](https://img.shields.io/github/r-package/v/Carol-seven/grasps?label=R%20in%20dev&color=green)](https://github.com/Carol-seven/grasps/blob/main/DESCRIPTION)
[![GitHub last commit](https://img.shields.io/github/last-commit/Carol-seven/grasps)](https://github.com/Carol-seven/grasps/commits/main)
[![R-CMD-check](https://github.com/Carol-seven/grasps/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/Carol-seven/grasps/actions/workflows/R-CMD-check.yaml)
[![GitHub License](https://img.shields.io/github/license/Carol-seven/grasps?color=blue)](https://github.com/Carol-seven/grasps/blob/main/LICENSE.md)
<!-- badges: end -->


The goal of **grasps** is to provide a collection of statistical methods that
incorporate both element-wise and group-wise penalties to estimate a precision
matrix, making them user-friendly and useful for researchers and practitioners.


$$
\hat{\Omega}(\lambda,\alpha,\gamma)
= \operatorname*{arg\,min}_{\Omega \succ 0} \Bigl\{
- \log\det(\Omega) + \operatorname{tr}(S\Omega)
+ P_{\lambda,\alpha,\gamma}(\Omega) \Bigr\},
$$
$$
P_{\lambda,\alpha,\gamma}(\Omega)
= \alpha P^\text{individual}_{\lambda,\gamma}(\Omega)
+ (1-\alpha) P^\text{group}_{\lambda,\gamma}(\Omega),
$$
$$
P^\text{individual}_{\lambda,\gamma}(\Omega)
= \sum_{i,j} p_{\lambda,\gamma}(\vert\omega_{ij}\vert),
$$
$$
P^\text{group}_{\lambda,\gamma}(\Omega)
= \sum_{g,g^\prime} p_{\lambda,\gamma}(\Vert\Omega_{gg^\prime}\Vert_F).
$$


For more details, see the vignette
[Penalized Precision Matrix Estimation in grasps](https://shiying-xiao.com/grasps/articles/pen_est#sparse-group-estimator).


## Penalties


The package **grasps** provides functions to estimate precision matrices using
the following penalties:


| Penalty | Reference |
|:--------|:----------|
| Lasso (`penalty = "lasso"`) | @tibshirani1996regression; @friedman2008sparse |
| Adaptive lasso (`penalty = "adapt"`) | @zou2006adaptive; @fan2009network |
| Atan (`penalty = "atan"`) | @wang2016variable |
| Exp (`penalty = "exp"`) | @wang2018variable |
| Lq (`penalty = "lq"`) | @frank1993statistical; @fu1998penalized; @fan2001variable |
| LSP (`penalty = "lsp"`) | @candes2008enhancing |
| MCP (`penalty = "mcp"`) | @zhang2010nearly |
| SCAD (`penalty = "scad"`) | @fan2001variable; @fan2009network |


See the vignette
[Penalized Precision Matrix Estimation in grasps](https://shiying-xiao.com/grasps/articles/pen_est#penalties)
for more details.


## Installation


You can install the development version of **grasps** from
[GitHub](https://github.com/) with:


```
# install.packages("devtools")
devtools::install_github("Carol-seven/grasps")
```


## Example


```{r}
library(grasps)

## reproducibility for everything
set.seed(1234)

## block-structured precision matrix based on SBM
sim <- gen_prec_sbm(d = 100, K = 5,
                    within.prob = 0.5, between.prob = 0.05,
                    weight.dists = list("gamma", "unif"),
                    weight.paras = list(c(shape = 20, scale = 5), c(min = 0, max = 1)),
                    cond.target = 100)

## synthetic data
library(MASS)
X <- MASS::mvrnorm(n = 50, mu = rep(0, 100), Sigma = sim$Sigma)

## solution
res <- grasps(X = X, membership = sim$membership, penalty = "lasso", crit = "BIC")

## visualization
plot(res)
```


## Reference {-}

